<div class="dashboard-container">
  <h1>Admin Dashboard</h1>

  <div class="main-content">
    <!-- LEFT CONTENT -->
    <div class="analytics-section">
      <h2>📊 Asset + User Analytics</h2>

      <!-- User Role Cards -->
      <div class="analytics-cards">
        <div class="analytics-card">
          <i class="fas fa-users card-icon"></i>
          <div>
            <h3>{{ totalUsers }}</h3>
            <p>Total Users</p>
          </div>
        </div>
        <div class="analytics-card">
          <i class="fas fa-user card-icon"></i>
          <div>
            <h3>{{ users }}</h3>
            <p>Normal Users</p>
          </div>
        </div>
        <div class="analytics-card">
          <i class="fas fa-user-cog card-icon"></i>
          <div>
            <h3>{{ contributors }}</h3>
            <p>Contributors</p>
          </div>
        </div>
        <div class="analytics-card">
          <i class="fas fa-user-shield card-icon"></i>
          <div>
            <h3>{{ admins }}</h3>
            <p>Admins</p>
          </div>
        </div>
      </div>

      <!-- User Charts -->
      <div class="charts">
        <div class="mini-user-chart">
          <h3>🔥 Most Active Users</h3>
          <app-chart [type]="'bar'" [data]="mostActiveUsersChartData"></app-chart>
        </div>
        <div class="mini-user-chart">
          <h3>🚀 Top Contributors</h3>
          <app-chart [type]="'bar'" [data]="topContributorsChartData"></app-chart>
        </div>
      </div>

      <!-- Asset Charts -->
      <app-chart *ngIf="statusChart"
        [type]="statusChart.type"
        [data]="statusChart.data"
        [options]="statusChart.options">
      </app-chart>

      <app-chart *ngIf="ratingChart"
        [type]="ratingChart.type"
        [data]="ratingChart.data"
        [options]="ratingChart.options">
      </app-chart>

      <app-chart *ngIf="uploadTrendChart"
        [type]="uploadTrendChart.type"
        [data]="uploadTrendChart.data"
        [options]="uploadTrendChart.options">
      </app-chart>

      <!-- Top Rated / Downloaded -->
      <div class="stat-box">
        <h3>🏆 Top Rated Assets</h3>
        <ul>
          <li *ngFor="let asset of topRatedAssets">{{ asset }}</li>
        </ul>
      </div>

      <div class="stat-box" *ngIf="mostDownloadedAsset">
        <h3>⬇️ Most Downloaded Asset</h3>
        <p>{{ mostDownloadedAsset.name || mostDownloadedAsset.label }}</p>
        <p>Downloads: {{ mostDownloadedAsset.downloadCount }}</p>
      </div>

      <!-- Sentiment Toggle -->
      <div class="sentiment-toggle">
        <button (click)="activeSentimentChart = 'positive'" [class.active]="activeSentimentChart === 'positive'">
          👍 Top Positive Assets
        </button>
        <button (click)="activeSentimentChart = 'negative'" [class.active]="activeSentimentChart === 'negative'">
          👎 Top Negative Assets
        </button>
      </div>

      <div *ngIf="activeSentimentChart === 'positive' && topPositiveAssetsChart">
        <app-chart 
          [type]="topPositiveAssetsChart.type" 
          [data]="topPositiveAssetsChart.data" 
          [options]="topPositiveAssetsChart.options">
        </app-chart>
      </div>

      <div *ngIf="activeSentimentChart === 'negative' && topNegativeAssetsChart">
        <app-chart 
          [type]="topNegativeAssetsChart.type" 
          [data]="topNegativeAssetsChart.data" 
          [options]="topNegativeAssetsChart.options">
        </app-chart>
      </div>
    </div>

    <!-- RIGHT SIDEBAR -->
    <div class="dashboard-right">
      <div class="mini-user-list">
        <div class="mini-list-title">🆕 New Users This Month</div>
        <div *ngFor="let user of newUsersThisMonth" class="mini-user-item">
          <div class="user-info">
            <span class="user-name">{{ user.firstName }} {{ user.lastName }}</span>
            <span class="user-role">{{ user.role }}</span>
          </div>
          <div class="user-date">
            <span class="badge">{{ user.createdAt | date: 'shortDate' }}</span>
          </div>
        </div>
        <div class="new-user-count">
          Total: <strong>{{ newUsersThisMonth.length }}</strong> new users this month
        </div>
      </div>
    </div>
  </div>
</div>
